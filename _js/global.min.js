"use strict";function toggleMenu(){var e=0,t=$("#mobi_menu").height()+e,n=Math.abs(parseFloat($("#panel").css("bottom"))),r=n==0?"-"+t+"px":0;$("#panel").animate({bottom:r})}function viewRotate(){var e=$("#iframe_view"),t=e.css("width"),n=e.css("height");e.animate({width:n,height:t})}var storage,timer,cards,mobi,window_timer=0;storage={check:function(e){return localStorage[e]?!0:!1},set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},"delete":function(e){localStorage.removeItem(e)}};timer={cur:"",idx:0,tmr:{hr:0,min:0,sec:0},init:function(){},get:function(){return storage.get(mobi.site).cards[timer.idx].timer},set:function(){var e=mobi.sites.get();e.cards[timer.idx].timer=timer.tmr;storage.set(mobi.site,e)},start_stop:function(e){var t="&plus;",n=$("#"+e+" .start_stop");timer.tmr=timer.get();n.toggleClass("stop").toggleClass("start");if(n.hasClass("stop")){timer.cur=e;timer.idx=parseFloat(e);timer.start();t="&times;"}else timer.stop();n.html(t)},start:function(){var e=$("#"+this.cur+" > input"),t=timer.tmr.hr?this.tmr.hr+":":"00:",n=timer.tmr.min?this.tmr.min+":":"00:",r=timer.tmr.sec?this.tmr.sec:"00";t=parseFloat(t)>0&&parseFloat(t)<10?"0"+t:t;n=parseFloat(n)>0&&parseFloat(n)<10?"0"+n:n;r=parseFloat(r)>0&&parseFloat(r)<10?"0"+r:r;this.tmr.sec++;if(this.tmr.sec==60){this.tmr.sec=0;this.tmr.min++}if(this.tmr.min==60){this.tmr.min=0;this.tmr.hr++}timer.set();e.val(t+n+r);window_timer=setTimeout("timer.start()",1e3)},stop:function(){window.clearTimeout(window_timer)},reset:function(){}};cards={init:function(){var e;cards.list();$('button[data-action="delete"]').on("click",cards.delete);$("#mobi_menu_container ol").sortable({revert:!0,start:function(t,n){e=$("#"+n.item[0].id);e.addClass("dragging")},stop:function(){e.removeClass("dragging");cards.cardSort()}});$(".card_options_menu").on("click",function(){var e=$(this).height()-18,t=Math.abs(parseFloat($(this).css("bottom"))),n=t==0?"-"+e+"px":0;$(this).animate({bottom:n})});$("#mobi_menu_container ol,#mobi_menu_container li").disableSelection();return!1},cardBlank:function(){return{title:"",page:"",status:"",desc:""}},cardScroll:function(e,t){var n=this.id,r=$("#mobi_menu_cards").width(),i=$("#mobi_menu_cards ol"),s=i.scrollLeft(),o=i.width(),u=411,a=!1,f;switch(n){case"cards_scroll_l":f=Math.abs(s)-u;break;case"cards_scroll_r":f=Math.abs(s+u)}i.animate({scrollLeft:f})},cardSort:function(e,t){var n=[],r=mobi.sites.get().cards;$("#mobi_menu_container ol li").each(function(){n.push(r[parseFloat(this.id)])});r=n},cardHTML:function(e,t){var n='<div class="card_options_menu" onclick=""><div class="card_options_button"></div><div class="card_options">';n+='<button data-action="archive" data-id="'+t+'">archive</button>';n+='<button data-action="delete" data-id="'+t+'">delete</button>';n+="</div></div>";var r='<div id="'+t+'-timer" class="timer">';r+='<button class="start_stop start" onclick="timer.start_stop(\''+t+"-timer')\">&plus;</button>";r+='<button class="reset">&oplus;</button>';r+='<input type="text" name="timer" placeholder="00:00:00" value="" readonly="readonly">';r+="</div>";var i=n;i+='<input type="text" name="title" placeholder="title" value="'+e.title+'">';i+=r;i+='<label for="page">page</label><input type="text" name="page" placeholder="*.html" value="'+e.page+'">';i+='<textarea name="desc" placeholder="notes">'+e.desc+"</textarea>";i='<li class="card" id="'+t+'"><div>'+i+"</div></li>";return i},list:function(){var e=mobi.sites.get().cards,t="";for(var n in e)e[n]!=null&&(t+=this.cardHTML(e[n],n+"-card"));$("#mobi_menu_container ol").html(t)},create:function(e){var t,n=$("#add_card").attr("data-state"),r=$("#mobi_menu_container ol"),i=cards.cardHTML(cards.cardBlank(),"new_card");switch(n){case"add":t="close";$("#add_card").html("&times;");r.append(i);$("#new_card > div").fadeIn({duration:200,complete:function(){$('#new_card input[name="title"]').focus()}});break;case"close":t="add";$("#add_card").html("&plus;");$("#new_card").hide().remove()}$("#add_card").attr("data-state",t)},add:function(e){var t=mobi.sites.get(),n=t.cards;n.push(e);t.cards=n;storage.set(mobi.site,t)},save:function(){var e={title:$('#new_card [name="title"]').val(),page:$('#new_card [name="page"]').val(),status:$('#new_card [name="status"]').val(),desc:$('#new_card [name="desc"]').val(),timer:{hr:0,min:0,sec:0},ticket:0};if(e.title){this.add(e);this.create();this.list()}},"delete":function(e){var t=storage.get("cards"),n=$(this).data("id");t[mobi.site].splice(parseFloat(n),1);$("#"+n).hide(175,function(){$(this).remove()})}};mobi={init:function(){mobi.site=$("#iframe_view").attr("src");this.history.init();this.devices.display();this.sites.init();cards.init()},site:"",sites:{init:function(){this.set(mobi.site);cards.list()},get:function(){return storage.get(mobi.site)},set:function(e){var t={url:e,title:e,desc:e,cards:[],settings:{}};storage.check(e)||storage.set(e,t)}},devices:{list:{fullscreen:{width:"100%",height:"100%"},desktop:{width:"1600px",height:"850px"},ipad:{width:"1024px",height:"768px"},iphone5:{width:"320px",height:"568px"},iphone4:{width:"320px",height:"480px"},galaxy:{width:"360px",height:"640px"},droidtab:{width:"1280px",height:"800px"}},active:function(e){$("#devices ul li").removeClass("active");$("#"+e).attr("class","active");storage.set("view",e)},display:function(){var e="",t=mobi.devices.list;for(var n in t)e+='<li id="'+n+'" class=""><div class="'+n+'">'+n+"</div></li>";$("#devices ul").html(e)},view:function(e){this.active(e);var t=this.list[e],n=$(".content_container");e=="fullscreen"?n.addClass("fullscreen"):n.removeClass("fullscreen");$("#iframe_view").animate({width:t.width,height:t.height})}},history:{init:function(){var e=this.get(),t=e[e.length-1];if(!storage.check("url_history"))storage.set("url_history",[]);else{$("#iframe_view").attr("src","http://"+t);$("#url_input").val(t)}mobi.site=$("#url_input").val();this.list()},set:function(e){var t=storage.get("url_history"),n=t.indexOf("url");t.push(e);storage.set("url_history",t)},get:function(){var e=storage.get("url_history");if(!e){e=[];storage.set("url_history",e)}return e},list:function(){var e=storage.get("url_history"),t="";e.reverse();for(var n in e)t+='<li><a href="#" class="history_url" data-url="'+e[n]+'">'+e[n]+"</a></li>";$("#history_menu ul").html(t)}},go:function(e){mobi.site=e;mobi.history.set(e);mobi.sites.init();$("#url_input").blur();$("#iframe_view").attr("src","http://"+e)},refresh:function(){this.go(mobi.site)}};$(function(){var e;$(document).keypress(function(e){function n(e){mobi.devices.view(e)}var t;switch(e.which){case 8710:toggleMenu();break;case 730:t=Math.abs(parseFloat($("#panel").css("bottom")));t&&toggleMenu();cards.create();break;case 13:e.target.parentNode.offsetParent.id=="new_card"&&cards.save();break;case 186:n("fullscreen");break;case 161:n("desktop");break;case 8482:n("ipad");break;case 163:n("iphone5");break;case 162:n("iphone4");break;case 8734:n("galaxy");break;case 167:n("droidtab");break;case 171:viewRotate()}});$("#modal").draggable();e=$("#iframe_view");if(!storage.check("view"))mobi.devices.view("fullscreen");else{e.attr("class",storage.get("view"));mobi.devices.active(storage.get("view"))}$("#rotate_iframe").on("click",function(){viewRotate()});$("#frame_reload").on("click",function(e){e.preventDefault();mobi.refresh()});$("#menu_button").on("click",toggleMenu);$("#url_form").submit(function(e){var t;e.preventDefault();t=$("#url_input").val();mobi.go(t);cards.list()});$("#frame_history").on("click",function(e){e.preventDefault();$("#history_menu").fadeToggle()});$(".history_url").on("click",function(e){e.preventDefault();$("#history_menu").fadeToggle();mobi.go($(this).data("url"))});$("#add_card").on("click",cards.create);$("#devices ul li div").on("click",function(e){e.preventDefault();mobi.devices.view(this.id)});$(".card_scroll").on("click",cards.cardScroll);mobi.init()});